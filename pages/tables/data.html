<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Create Reports</title>

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="../../plugins/fontawesome-free/css/all.min.css">
  <!-- DataTables -->
  <link rel="stylesheet" href="../../plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="../../plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
  <link rel="stylesheet" href="../../plugins/datatables-buttons/css/buttons.bootstrap4.min.css">
  <link rel="stylesheet" href="../../plugins/jquery-confirm/jquery-confirm.css">
  <link rel="stylesheet" href="../../dist/js/datepicker/sass/bootstrap-datetimepicker-build.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="../../dist/css/adminlte.min.css">
</head>

<body class="hold-transition sidebar-mini  sidebar-collapse">
  <div class="wrapper">
    <!-- Navbar -->
    <nav class="main-header navbar navbar-expand navbar-white navbar-light">
      <!-- Left navbar links -->
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
        </li>
        <li class="nav-item d-none d-sm-inline-block">
          <a href="data.html" class="nav-link">Home</a>
        </li>
        <li class="nav-item d-none d-sm-inline-block">
          <a href="#" class="nav-link">Contact</a>
        </li>
      </ul>

      <!-- SEARCH FORM -->
      <form class="form-inline ml-3">
        <div class="input-group input-group-sm">
          <input class="form-control form-control-navbar" type="search" placeholder="Search" aria-label="Search">
          <div class="input-group-append">
            <button class="btn btn-navbar" type="submit">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </div>
      </form>
    </nav>
    <!-- /.navbar -->

    <!-- Main Sidebar Container -->
    <aside class="main-sidebar sidebar-dark-primary elevation-4">
      <!-- Brand Logo -->
      <a href="data.html" class="brand-link">
        <img src="../../dist/img/AdminLTELogo.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3"
          style="opacity: .8">
        <span class="brand-text font-weight-light">FMS-Reports</span>
      </a>


      <!-- Sidebar Menu -->
      <nav class="mt-2">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
          <!-- Add icons to the links using the .nav-icon class
               with font-awesome or any other icon font library -->
          <li class="nav-item menu-open">
            <a href="#" class="nav-link active">
              <i class="nav-icon fas fa-tachometer-alt"></i>
              <p>
                Dashboard
                <i class="right fas fa-angle-left"></i>
              </p>
            </a>
          </li>
          <li class="nav-item">
            <a href="data.html" class="nav-link">
              <i class="far fa-circle nav-icon"></i>
              <p>Create Reports</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="fleetreports.html" class="nav-link">
              <i class="far fa-circle nav-icon"></i>
              <p>Fleet Report</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="gensets.html" class="nav-link">
              <i class="far fa-circle nav-icon"></i>
              <p>Gensets Report</p>
            </a>
          </li>
        </ul>
      </nav>
      <!-- /.sidebar-menu -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
      <!-- Content Header (Page header) -->
      <section class="content-header">
        <div class="container-fluid">
          <div class="row mb-2">
            <div class="col-sm-6">
              <h1>Fleet Reports</h1>
            </div>
            <div class="col-sm-6">
              <ol class="breadcrumb float-sm-right">
                <li class="breadcrumb-item"><a href="#">Home</a></li>
                <li class="breadcrumb-item active">Fleet Reports</li>
              </ol>
            </div>
          </div>
        </div><!-- /.container-fluid -->
      </section>

      <!-- Main content -->
      <section class="content">
        <div class="container-fluid">
          <!-- Date picker  -->
          <div class="row">
            <div class="col-md-5">
              <input type="date" class="form-control" id="startdate">
            </div>
            <div class="col-md-5">
              <input type="date" class="form-control" id="enddate">
            </div>
            <div class="col-md-2">
              <button class="btn btn-primary" onclick="generateReport()"><i class="fa fa-download"></i> Generate
                Report</button>
            </div>
          </div>
          <div class="row" style="padding: 20px;">
            <div class="col-md-4">
              <button class="btn btn-sm btn-success"><i class="fa fa-eye"></i> View Report</button>
            </div>
            <div class="col-md-4">
              <button class="btn btn-sm btn-warning" onclick="createReports()"><i class="fa fa-plus"></i>Create
                Report</button>
            </div>
            <div class="col-md-4">
              <button class="btn btn-sm btn-danger" onclick="deleteAllReportsAvailable()"><i
                  class="fa fa-trash"></i>Delete Report</button>
            </div>
          </div>
          <!-- tables  -->
          <div class="row">
            <div class="col-12">
              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Available Reports</h3>
                </div>
                <!-- /.card-header -->
                <div class="card-body">
                  <div id="available-reports" onclick="window.location.href='fleetreports.html'">
                    <div class="text-center">
                      <div class="spinner-grow text-secondary" role="status">
                        <span class="sr-only">Loading...</span>
                      </div>
                    </div>
                  </div>
                  <!-- <table class="table table-bordered" id="dataTable">
                    <thead>
                      <tr>
                        <th>Vehicle</th>
                        <th>StartDate</th>
                        <th>EndDate</th>
                        <th>DistanceTravelled</th>
                        <th>TotalEngineTime[Km]</th>
                        <th>TotalIdleTime</th>
                        <th>FuelConsumtionRate[Km/Litre]</th>
                        <th>OverallConsumption</th>
                        <th>AbnormalConsumed[Litre]</th>
                        <th>OverallRefueled[Litre]</th>
                      </tr>
                    </thead>
                    <tbody id="table-bod">
                      <tr>
                        <td>UAT 912X</td>
                        <td>01/08/2021</td>
                        <td>01/08/2021</td>
                        <td>0.00</td>
                        <td>00:00:00</td>
                        <td>0.00</td>
                        <td>0.00</td>
                        <td>0.00</td>
                        <td>0.00</td>
                        <td>0.00</td>
                      </tr>
                    </tbody>
                  </table> -->
                </div>
                <!-- /.card-body -->
              </div>
              <!-- /.card -->
            </div>
            <!-- /.col -->
          </div>
          <!-- /.row -->
        </div>
        <!-- /.container-fluid -->
      </section>
      <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->
    <footer class="main-footer">
      <div class="float-right d-none d-sm-block">
        <b>Version</b> 3.1.0-rc
      </div>
      <strong>Copyright &copy; 2014-2021 <a href="https://teesatechnologies.com">Teesa Technologies</a>.</strong> All
      rights reserved.
    </footer>

    <!-- Control Sidebar -->
    <aside class="control-sidebar control-sidebar-dark">
      <!-- Control sidebar content goes here -->
    </aside>
    <!-- /.control-sidebar -->
  </div>
  <!-- ./wrapper -->

  <!-- jQuery -->
  <script src="../../plugins/jquery/jquery.min.js"></script>
  <!-- Bootstrap 4 -->
  <script src="../../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
  <!-- DataTables  & Plugins -->
  <script src="../../plugins/datatables/jquery.dataTables.min.js"></script>
  <script src="../../plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
  <script src="../../plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
  <script src="../../plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
  <script src="../../plugins/jquery-confirm/jquery-confirm.js"></script>
  <script src="../../plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
  <script src="../../plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
  <script src="../../plugins/jszip/jszip.min.js"></script>
  <script src="../../plugins/pdfmake/pdfmake.min.js"></script>
  <script src="../../plugins/pdfmake/vfs_fonts.js"></script>
  <script src="../../plugins/datatables-buttons/js/buttons.html5.min.js"></script>
  <script src="../../plugins/datatables-buttons/js/buttons.print.min.js"></script>
  <script src="../../plugins/datatables-buttons/js/buttons.colVis.min.js"></script>
  <script src="../../dist/js/datepicker/js/Moment.js"></script>
  <script src="../../dist/js/datepicker/js/bootstrap-datetimepicker.js"></script>
  <!-- AdminLTE App -->
  <script src="../../dist/js/adminlte.min.js"></script>
  <!-- AdminLTE for demo purposes -->
  <script src="../../dist/js/demo.js"></script>
  <!-- Page specific script -->
  <script>
    var trackerlist = [];
    var reportlist = [];
    $(function () {
      $("#dataTable").DataTable();
      // $('#dataTable').DataTable({
      //   "paging": true,
      //   "lengthChange": false,
      //   "searching": false,
      //   "ordering": true,
      //   "info": true,
      //   "autoWidth": false,
      //   "responsive": true,
      // });
      // $("#exampletime").datetimepicker();
      // $("#exampletime2").datetimepicker();
    });

    $(document).ready(function () {
      $.ajax({
        url: "https://hosting.fms-ecsinternational.com/api/report/tracker/list",
        type: 'GET',
        data: {
          hash: "ce9aaa3428e3f4f2f71b17bc004ecb3e"
        },
        success: function (response) {
          console.log(response);
          if (response.list.length > 0) {
            $('#available-reports').html('<div class="tile"> <h3>Fleet Report</h3><br><h4> Created :' + new Date(response.list[0].created).toLocaleString() + ' <h4><br><h4>From :' + new Date(response.list[0].from).toLocaleString() + '</h4><br><h4> To: ' + new Date(response.list[0].to).toLocaleString() + '</h4></div>');
            for (var i = 0; i < response.list.length; i++) {
              console.log(response.list[i].id);
              avaliableReports.push({ 'id': response.list[i].id, 'report_title': response.list[i].title });
            }
            console.log("Available Reports List: ");
            console.log(avaliableReports);
          } else {
            $.confirm({
              title: 'Error',
              content: 'There is no report currently, please generate one and try again!',
              useBootstrap: false,
              type: 'red',
              theme: 'modern',
              icon: 'fa fa-exclamation-triangle',
              buttons: {
                close: {
                  text: 'Close',
                  action: function () { }
                }
              }
            });
          }
        },
        async: false,
        error: function (error) {
          console.log(error);
        }
      });

    });
    function checkenddate() {
      if ($('#startdate').val() !== '' && $('#enddate').val() !== '') {
        var start = Date.parse(($('#startdate').val()).toString());
        var end = Date.parse(($('#enddate').val()).toString());
        console.log($('#enddate').val());
        if (start > end) {
          //            $('#eDate').css('border-color', '#ff0000');
          $('#startdate').val('');
          $('#enddate').focus();
          return false;
        } else {
          $('#enddate').css('border-color', '#C0C0C0');
          return true;
        }
      } else {
        alert("Please Select a date range");
        return false;
      }

      return true;
    }

    // function viewFleetOperationsreport() {
    //   //Retieve Trip Report
    //   var tripreport;
    //   var enginehours;
    //   $.ajax({
    //     url: 'https://hosting.fms-ecsinternational.com/api/report/tracker/retrieve',
    //     data: {
    //       hash: "ce9aaa3428e3f4f2f71b17bc004ecb3e",
    //       report_id: 24506
    //     },
    //     type: 'GET',
    //     success: function (response) {

    //     }, error: function () {
    //       alert('There has been an error, Please Try again');
    //     },
    //     async: false
    //   });



    //   //Retieve Engine Hours
    //   $.ajax({
    //     url: 'https://hosting.fms-ecsinternational.com/api/report/tracker/retrieve',
    //     data: {
    //       hash: "02d4aad3606697c7255b5aa2c12ff00a",
    //       report_id: 24506
    //     },
    //     type: 'GET',
    //     success: function (response) {

    //     }, error: function () {
    //       alert('There has been an error, Please Try again');
    //     },
    //     async: false
    //   });
    // }

    function generateReport() {
      var startDate = $('#startdate').val();
      var endDate = $('#enddate').val();
      if (checkenddate()) {
        $('#table-bod').html('<div><div class="spinner-grow text-primary pull-center"></div></div>');

        startDate = startDate.replace("/", "-") + ' 00:00:00';
        endDate = endDate.replace("/", "-") + ' 23:59:59';
        console.log(endDate + "   " + startDate);
        $.ajax({
          url: 'https://hosting.fms-ecsinternational.com/api/tracker/list',
          data: {
            hash: "ce9aaa3428e3f4f2f71b17bc004ecb3e"
          },
          type: 'GET',
          success: function (response) {
            // debugger;
            console.log(response);
            var vehicles = response.list;
            $('#table-bod').html('');

            for (var i = 0; i < vehicles.length; i++) {
              console.log(vehicles[i].label);
              var distancetraveled = 0;
              var enginetime = 0;

              $.ajax({
                url: 'https://hosting.fms-ecsinternational.com/api/track/list',
                data: {
                  hash: "02d4aad3606697c7255b5aa2c12ff00a",
                  tracker_id: vehicles[i].id,
                  type: "engine_hours",
                  from: startDate,
                  to: endDate
                },
                type: 'GET',
                success: function (resp) {
                  // debugger;
                  console.log(resp);
                  var tracks = resp.list;
                  for (var x = 0; x < tracks.length; x++) {
                    distancetraveled = distancetraveled + tracks[x].length;
                  }

                }, error: function () {
                  alert('There has been an error, Please Try again');
                },
                async: false
              });



              $.ajax({
                url: 'https://hosting.fms-ecsinternational.com/api/tracker/stats/engine_hours/read',
                data: {
                  hash: "02d4aad3606697c7255b5aa2c12ff00a",
                  tracker_id: vehicles[i].id,
                  type: "engine_hours",
                  from: startDate,
                  to: endDate
                },
                type: 'GET',
                success: function (resp) {
                  // debugger;
                  console.log(resp);
                  enginetime = resp.value;

                }, error: function (error) {
                  console.log(error);
                },
                async: false
              });

              //Append Fetched values to datatable
              var row = '<tr>' +
                ' <td>' + vehicles[i].label + '</td>' +
                ' <td>' + startDate + '</td>' +
                ' <td>' + endDate + '</td>' +
                ' <td>' + distancetraveled + '</td>' +
                ' <td>' + enginetime + '</td>' +
                ' <td>0.00</td>' +
                ' <td>0.00</td>' +
                ' <td>0.00</td>' +
                ' <td>0.00</td>' +
                ' <td>0.00</td>' +
                '</tr>';

              $('#table-bod').append(row);


            }
          }
        });
      } else {
        $.confirm({
          title: 'Error',
          content: 'Please select a valid date range!',
          useBootstrap: false,
          type: 'red',
          theme: 'modern',
          icon: 'fa fa-exclamation-triangle',
          buttons: {
            close: {
              text: 'Close',
              action: function () { }
            }
          }
        });
      }
    }
    function createReports() {
      const createReportsAsync = async () => {

        var startDate = $('#startdate').val();
        var endDate = $('#enddate').val();
        if (checkenddate()) {
          debugger;
          startDate = startDate.replace("/", "-") + ' 00:00:00';
          endDate = endDate.replace("/", "-") + ' 23:59:59';
          console.log(endDate + "   " + startDate);

          // 1. Get all assets to be tracked 
          if (trackerlist.length == 0) {
            $.ajax({
              url: 'https://hosting.fms-ecsinternational.com/api/tracker/list',
              data: {
                hash: "ce9aaa3428e3f4f2f71b17bc004ecb3e"
              },
              type: 'GET',
              success: function (response) {
                // debugger;
                console.log(response);
                var vehicles = response.list;
                for (var i = 0; i < vehicles.length; i++) {
                  console.log(vehicles[i].label);
                  trackerlist.push(vehicles[i].id);
                }
                console.log(trackerlist);
              }, error: function (error) {
                console.log(error);
              },
              async: false
            });
          }


          // // 2. Generate reports for selected period
          // // 2.1  Trip report 
          // var plugin = {
          //   "hide_empty_tabs": true,
          //   "plugin_id": 4,
          //   "show_seconds": false,
          //   "include_summary_sheet_only": false,
          //   "split": true,
          //   "show_idle_duration": false,
          //   "show_coordinates": false,
          //   "filter": true,
          //   "group_by_driver": true
          // };

          // var dataObject = {
          //   "plugin": plugin,
          //   "hash": 'd6044df83f69e93b88d5cb660504a8a0',
          //   "title": 'Trip report',
          //   "trackers": trackerlist,
          //   "from": startDate,
          //   "to": endDate,
          //   "time_filter": {
          //     "from": "00:00:00",
          //     "to": "23:59:59",
          //     "weekdays": [1, 2, 3, 4, 5, 6, 7]
          //   }
          // };

          // console.log(dataObject);
          // console.log(JSON.stringify(dataObject));
          // console.log(JSON.parse(JSON.stringify(dataObject)));
          // debugger;
          // $.ajax({
          //   url: "https://hosting.fms-ecsinternational.com/api/report/tracker/generate",
          //   contentType: "application/json",
          //   type: 'GET',
          //   data: {
          //     "plugin": {
          //       "hide_empty_tabs": true,
          //       "plugin_id": 4,
          //       "show_seconds": false,
          //       "include_summary_sheet_only": false,
          //       "split": true,
          //       "show_idle_duration": false,
          //       "show_coordinates": false,
          //       "filter": true,
          //       "group_by_driver": true
          //     },
          //     "time_filter": {
          //       "from": "00:00:00",
          //       "to": "23:59:59",
          //       "weekdays": [1, 2, 3, 4, 5, 6, 7]
          //     },
          //     "hash": "d6044df83f69e93b88d5cb660504a8a0",
          //     "title": "Trip report",
          //     "trackers": [5080, 5083, 5102, 5166, 5275],
          //     "from": "2021-09-15 00:00:00",
          //     "to": "2021-09-15 23:59:59"
          //   },
          //   success: function (response) {
          //     debugger;
          //     console.log(response);
          //     reportlist.push(response.id);
          //   },
          //   async: false,
          //   error: function (error) {
          //     debugger;
          //     console.log(error.responseJSON);
          //   }
          // });



          //Using the javascript API to create reports
          // 2.1 Trip Report 

          var tripReportdata = {
            "plugin": {
              "hide_empty_tabs": true,
              "plugin_id": 4,
              "show_seconds": true,
              "include_summary_sheet_only": false,
              "split": true,
              "show_idle_duration": true,
              "show_coordinates": false,
              "filter": true,
              "group_by_driver": true
            },
            "time_filter": {
              "from": "00:00:00",
              "to": "23:59:59",
              "weekdays": [1, 2, 3, 4, 5, 6, 7]
            },
            "hash": "ce9aaa3428e3f4f2f71b17bc004ecb3e",
            "title": "Trip report",
            "trackers": trackerlist,
            "from": startDate,
            "to": endDate
          };
          await fetch('https://hosting.fms-ecsinternational.com/api/report/tracker/generate',
            {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(tripReportdata),
            })
            .then(response => response.json())
            .then(data => {
              console.log(data);
              console.log('Success:', data);
              reportlist.push(data.id);
            })
            .catch((error) => {
              console.log('Error', error);
            });


          // 2.2 Eco Driving Report 
          var ecoReportdata = {
            "hash": "ce9aaa3428e3f4f2f71b17bc004ecb3e",
            "title": "Eco-driving report",
            "trackers": trackerlist,
            "from": startDate,
            "to": endDate,
            "time_filter": { "from": "00:00:00", "to": "23:59:59", "weekdays": [1, 2, 3, 4, 5, 6, 7] },
            "plugin": {
              "hide_empty_tabs": true, "plugin_id": 46, "show_seconds": true, "include_summary_sheet_only": false, "split": true, "show_idle_duration": true, "show_coordinates": false, "filter": true, "group_by_driver": true, "show_detailed": true,
              "min_duration_minutes": 1, "max_speed": 60, "smoothing": false, "graph_type": "mileage"
            }
          }


          await fetch('https://hosting.fms-ecsinternational.com/api/report/tracker/generate',
            {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(ecoReportdata),
            })
            .then(response => response.json())
            .then(data => {
              console.log(data);
              console.log('Success:', data);
              reportlist.push(data.id);
            })
            .catch((error) => {
              console.log('Error', error);
            });



          // 2.3 Engine Hours Report 
          var engineHoursdata = {
            hash: "ce9aaa3428e3f4f2f71b17bc004ecb3e",
            title: "Engine hours report",
            trackers: trackerlist,
            from: startDate,
            to: endDate,
            time_filter: { from: "00:00:00", to: "23:59:59", weekdays: [1, 2, 3, 4, 5, 6, 7] },
            plugin: {
              hide_empty_tabs: true,
              plugin_id: 7,
              show_seconds: true,
              include_summary_sheet_only: false,
              split: true,
              show_idle_duration: true,
              show_coordinates: false,
              filter: true,
              group_by_driver: true,
              show_detailed: true
            }
          }

          await fetch('https://hosting.fms-ecsinternational.com/api/report/tracker/generate',
            {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(engineHoursdata),
            })
            .then(response => response.json())
            .then(data => {
              console.log(data);
              reportlist.push(data.id);
              console.log('Success:', data);
            })
            .catch((error) => {
              console.log('Error', error);
            });


          // 2.4 Geo Fence Entry/Exit 
          var geoFencedata = {
            hash: "ce9aaa3428e3f4f2f71b17bc004ecb3e",
            title: "Geofence entry/exit events",
            trackers: trackerlist,
            from: startDate,
            to: endDate,
            time_filter: {
              from: "00:00:00",
              to: "23:59:59",
              weekdays: [1, 2, 3, 4, 5, 6, 7]
            },
            plugin: {
              hide_empty_tabs: true,
              plugin_id: 89,
              show_seconds: true,
              include_summary_sheet_only: false,
              split: true,
              show_idle_duration: true,
              show_coordinates: false,
              filter: true,
              group_by_driver: true,
              min_minutes_in_zone: 1
            }
          }

          await fetch('https://hosting.fms-ecsinternational.com/api/report/tracker/generate',
            {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(geoFencedata),
            })
            .then(response => response.json())
            .then(data => {
              console.log(data);
              console.log('Success:', data);
              reportlist.push(data.id);
            })
            .catch((error) => {
              console.log('Error', error);
            });

          // 2.5 Speed Violation Report
          var SpeedViolationdata = {
            hash: "ce9aaa3428e3f4f2f71b17bc004ecb3e",
            title: "Speed violation report",
            trackers: trackerlist,
            from: startDate,
            to: endDate,
            time_filter: {
              from: "00:00:00",
              to: "23:59:59",
              weekdays: [1, 2, 3, 4, 5, 6, 7]
            },
            plugin: {
              hide_empty_tabs: true,
              plugin_id: 27,
              show_seconds: true,
              include_summary_sheet_only: false,
              split: true,
              show_idle_duration: true,
              show_coordinates: false,
              filter: true,
              group_by_driver: true,
              show_detailed: true,
              min_duration_minutes: 1,
              max_speed: 100
            }
          }


          await fetch('https://hosting.fms-ecsinternational.com/api/report/tracker/generate',
            {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(SpeedViolationdata),
            })
            .then(response => response.json())
            .then(data => {
              console.log(data);
              reportlist.push(data.id);
              console.log('Success:', data);
            })
            .catch((error) => {
              console.log('Error', error);
            });


          // 2.6 Car Security Report 
          var CarSecurityData = {
            hash: "ce9aaa3428e3f4f2f71b17bc004ecb3e",
            title: "Car security report",
            trackers: trackerlist,
            from: startDate,
            to: endDate,
            time_filter: { from: "00:00:00", to: "23:59:59", weekdays: [1, 2, 3, 4, 5, 6, 7] },
            plugin: {
              hide_empty_tabs: true,
              plugin_id: 15,
              show_seconds: true,
              include_summary_sheet_only: false,
              split: true,
              show_idle_duration: true,
              show_coordinates: false,
              filter: true,
              group_by_driver: true,
              show_detailed: true,
              min_duration_minutes: 1,
              max_speed: 60
            }
          }

          await fetch('https://hosting.fms-ecsinternational.com/api/report/tracker/generate',
            {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(CarSecurityData),
            })
            .then(response => response.json())
            .then(data => {
              console.log(data);
              console.log('Success:', data);
              reportlist.push(data.id);
            })
            .catch((error) => {
              console.log('Error', error);
            });


          // 2.7 Fuel Volume Report 
          var fuelVolumeData = {
            hash: "ce9aaa3428e3f4f2f71b17bc004ecb3e",
            title: "Fuel report",
            trackers: trackerlist,
            from: startDate,
            to: endDate,
            time_filter: { from: "00:00:00", to: "23:59:59", weekdays: [1, 2, 3, 4, 5, 6, 7] },
            plugin: {
              hide_empty_tabs: true,
              plugin_id: 10,
              show_seconds: true,
              include_summary_sheet_only: false,
              split: true, show_idle_duration: true,
              show_coordinates: false,
              filter: true,
              group_by_driver: true,
              show_detailed: true,
              min_duration_minutes: 1,
              max_speed: 60,
              smoothing: false,
              graph_type: "mileage"
            }
          }


          await fetch('https://hosting.fms-ecsinternational.com/api/report/tracker/generate',
            {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(fuelVolumeData),
            })
            .then(response => response.json())
            .then(data => {
              console.log(data);
              console.log('Success:', data);
              reportlist.push(data.id);
            })
            .catch((error) => {
              console.log('Error', error);
            });


          // $.ajax({
          //   url: "https://hosting.fms-ecsinternational.com/api/report/tracker/generate",
          //   contentType: "application/json",
          //   type: 'GET',
          //   data: {
          //     "hash": "ce9aaa3428e3f4f2f71b17bc004ecb3e",
          //     "title": "Eco-driving report",
          //     "trackers": [3305, 3306, 3338, 3404, 3453, 3528, 3529, 3541, 4719, 4791, 6035],
          //     "from": "2021-08-22 00:00:00",
          //     "to": "2021-09-09 23:59:59",
          //     "time_filter": { "from": "00:00:00", "to": "23:59:59", "weekdays": [1, 2, 3, 4, 5, 6, 7] },
          //     "plugin": {
          //       "hide_empty_tabs": true, "plugin_id": 46, "show_seconds": false, "include_summary_sheet_only": false, "split": true, "show_idle_duration": true, "show_coordinates": false, "filter": true, "group_by_driver": true, "show_detailed": true,
          //       "min_duration_minutes": 1, "max_speed": 60, "smoothing": false, "graph_type": "mileage"
          //     }
          //   },
          //   success: function (response) {
          //     debugger;
          //     console.log(response);
          //     reportlist.push(response.id);
          //   },
          //   async: false,
          //   error: function (error) {
          //     debugger;
          //     console.log(error.responseJSON);
          //   }
          // });

          // // 2.2  Engine Hours report 
          // $.ajax({
          //   url: "https://hosting.fms-ecsinternational.com/api/report/tracker/generate",
          //   type: 'GET',
          //   data: {
          //     hash: "02d4aad3606697c7255b5aa2c12ff00a",
          //     title: "Engine hours report",
          //     trackers: trackerlist,
          //     from: startDate,
          //     to: endDate,
          //     time_filter: { from: "00:00:00", to: "23:59:59", weekdays: [1, 2, 3, 4, 5, 6, 7] },
          //     plugin: {
          //       hide_empty_tabs: true,
          //       plugin_id: 7,
          //       show_seconds: true,
          //       include_summary_sheet_only: false,
          //       split: true,
          //       show_idle_duration: true,
          //       show_coordinates: false,
          //       filter: true,
          //       group_by_driver: true,
          //       show_detailed: true
          //     }
          //   },
          //   success: function (response) {
          //     console.log(response.id);
          //     reportlist.push(response.id);
          //   },
          //   async: false,
          //   error: function (error) {
          //     console.log(error);
          //   }
          // });

          // // 2.3  Geofence entry/exit events report
          // $.ajax({
          //   url: "https://hosting.fms-ecsinternational.com/api/report/tracker/generate",
          //   type: 'GET',
          //   data: {
          //     hash: "02d4aad3606697c7255b5aa2c12ff00a",
          //     title: "Geofence entry/exit events",
          //     trackers: trackerlist,
          //     from: startDate,
          //     to: endDate,
          //     time_filter: {
          //       from: "00:00:00",
          //       to: "23:59:59",
          //       weekdays: [1, 2, 3, 4, 5, 6, 7]
          //     },
          //     plugin: {
          //       hide_empty_tabs: true,
          //       plugin_id: 89,
          //       show_seconds: true,
          //       include_summary_sheet_only: false,
          //       split: true,
          //       show_idle_duration: true,
          //       show_coordinates: false,
          //       filter: true,
          //       group_by_driver: true,
          //       min_minutes_in_zone: 1
          //     }
          //   },
          //   success: function (response) {
          //     console.log(response.id);
          //     reportlist.push(response.id);
          //   },
          //   async: false,
          //   error: function (error) {
          //     console.log(error);
          //   }
          // });


          // // 2.4  Eco-Driving report 
          // $.ajax({
          //   url: "https://hosting.fms-ecsinternational.com/api/report/tracker/generate",
          //   type: 'GET',
          //   data: {
          //     hash: "02d4aad3606697c7255b5aa2c12ff00a",
          //     title: "Eco-driving report",
          //     trackers: trackerlist,
          //     from: startDate,
          //     to: endDate,
          //     time_filter: { from: "00:00:00", to: "23:59:59", weekdays: [1, 2, 3, 4, 5, 6, 7] },
          //     plugin: {
          //       hide_empty_tabs: true,
          //       plugin_id: 46,
          //       show_seconds: true,
          //       include_summary_sheet_only: false,
          //       split: true,
          //       show_idle_duration: true,
          //       show_coordinates: false,
          //       filter: true,
          //       group_by_driver: true,
          //       show_detailed: true,
          //       min_duration_minutes: 1,
          //       max_speed: 60
          //     }
          //   },
          //   success: function (response) {
          //     console.log(response.id);
          //     reportlist.push(response.id);
          //   },
          //   async: false,
          //   error: function (error) {
          //     console.log(error);
          //   }
          // });

          // // 2.5  Speed Violation report
          // $.ajax({
          //   url: "https://hosting.fms-ecsinternational.com/api/report/tracker/generate",
          //   type: 'GET',
          //   data: {
          //     hash: "02d4aad3606697c7255b5aa2c12ff00a",
          //     title: "Speed violation",
          //     trackers: trackerlist,
          //     from: startDate,
          //     to: endDate,
          //     time_filter: {
          //       from: "00:00:00",
          //       to: "23:59:59",
          //       weekdays: [1, 2, 3, 4, 5, 6, 7]
          //     },
          //     plugin: {
          //       hide_empty_tabs: true,
          //       plugin_id: 27,
          //       show_seconds: true,
          //       include_summary_sheet_only: false,
          //       split: true,
          //       show_idle_duration: true,
          //       show_coordinates: false,
          //       filter: true,
          //       group_by_driver: true,
          //       show_detailed: true,
          //       min_duration_minutes: 1,
          //       max_speed: 60
          //     }
          //   },
          //   success: function (response) {
          //     console.log(response.id);
          //     reportlist.push(response.id);
          //   },
          //   async: false,
          //   error: function (error) {
          //     console.log(error);
          //   }
          // });

          // // 2.6  Car Security
          // $.ajax({
          //   url: "https://hosting.fms-ecsinternational.com/api/report/tracker/generate",
          //   type: 'GET',
          //   data: {
          //     hash: "02d4aad3606697c7255b5aa2c12ff00a",
          //     title: "Car security report",
          //     trackers: trackerlist,
          //     from: startDate,
          //     to: endDate,
          //     time_filter: { from: "00:00:00", to: "23:59:59", weekdays: [1, 2, 3, 4, 5, 6, 7] },
          //     plugin: {
          //       hide_empty_tabs: true,
          //       plugin_id: 15,
          //       show_seconds: true,
          //       include_summary_sheet_only: false,
          //       split: true,
          //       show_idle_duration: true,
          //       show_coordinates: false,
          //       filter: true,
          //       group_by_driver: true,
          //       show_detailed: true,
          //       min_duration_minutes: 1,
          //       max_speed: 60
          //     }
          //   },
          //   success: function (response) {
          //     console.log(response.id);
          //     reportlist.push(response.id);
          //   },
          //   async: false,
          //   error: function (error) {
          //     console.log(error);
          //   }
          // });

          // 2.7  Fuel Volume
          // $.ajax({
          //   url: "https://hosting.fms-ecsinternational.com/api/report/tracker/generate",
          //   type: 'GET',
          //   data: {
          //     hash: "02d4aad3606697c7255b5aa2c12ff00a",
          //     title: "Fuel volume report",
          //     trackers: trackerlist,
          //     from: startDate,
          //     to: endDate,
          //     time_filter: { from: "00:00:00", to: "23:59:59", weekdays: [1, 2, 3, 4, 5, 6, 7] },
          //     plugin: {
          //       hide_empty_tabs: true,
          //       plugin_id: 10,
          //       show_seconds: true,
          //       include_summary_sheet_only: false,
          //       split: true, show_idle_duration: true,
          //       show_coordinates: false,
          //       filter: true,
          //       group_by_driver: true,
          //       show_detailed: true,
          //       min_duration_minutes: 1,
          //       max_speed: 60,
          //       smoothing: false,
          //       graph_type: "mileage"
          //     }
          //   },
          //   success: function (response) {
          //     console.log(response.id);
          //     reportlist.push(response.id);
          //   },
          //   async: false,
          //   error: function (error) {
          //     console.log(error);
          //   }
          // });

          if (reportlist.length >= 6) {
            $.confirm({
              title: 'Success',
              content: 'Report Successfully Created',
              useBootstrap: false,
              type: 'green',
              theme: 'modern',
              icon: 'fa fa-tick',
              buttons: {
                close: {
                  text: 'Close',
                  action: function () { }
                }
              }
            });
          }
          console.log(reportlist);
        }
      }

      createReportsAsync();
    }
    function listAllReportsAvailable() {

    }

    function deleteAllReportsAvailable() {

      //Fetch existing reports
      if (reportlist.length === 0) {
        $.ajax({
          url: "https://hosting.fms-ecsinternational.com/api/report/tracker/list",
          type: 'GET',
          data: {
            hash: "ce9aaa3428e3f4f2f71b17bc004ecb3e"
          },
          success: function (response) {
            console.log(response);
            if (response.list.length > 0) {
              for (var i = 0; i < response.list.length; i++) {
                console.log(response.list[i].id);
                reportlist.push(response.list[i].id);
              }
              console.log("Reports List: " + reportlist);
            } else {
              $.confirm({
                title: 'Error',
                content: 'There is no report currently please generate one and try again!',
                useBootstrap: false,
                type: 'red',
                theme: 'modern',
                icon: 'fa fa-exclamation-triangle',
                buttons: {
                  close: {
                    text: 'Close',
                    action: function () { }
                  }
                }
              });
            }
          },
          async: false,
          error: function (error) {
            console.log(error);
          }
        });
      }
      // debugger;
      if (reportlist.length > 0) {
        for (var i = 0; i < reportlist.length; i++) {
          // Delete Report
          $.ajax({
            url: "https://hosting.fms-ecsinternational.com/api/report/tracker/delete",
            type: 'GET',
            data: {
              hash: "ce9aaa3428e3f4f2f71b17bc004ecb3e",
              report_id: reportlist[i]
            },
            success: function (response) {
              console.log(response);
              if (response.success === true) {
                console.log("Successfully deleted Report");
                $.confirm({
                  title: 'Success',
                  content: 'Report Successfully deleted',
                  useBootstrap: false,
                  type: 'success',
                  theme: 'modern',
                  icon: 'fa fa-tick',
                  buttons: {
                    close: {
                      text: 'Close',
                      action: function () { }
                    }
                  }
                });
              } else {
                console.log("Failed to delete Report, Please try again");
              }
            },
            async: false,
            error: function (error) {
              console.log(error);
            }
          });
        }
      }
    }

  </script>
</body>

</html>